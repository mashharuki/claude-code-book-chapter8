# プロダクト要求定義書 (Product Requirements Document)

## プロダクト概要

### 名称
**TaskCLI** - Gitと一体化したタスク管理CLIツール

### プロダクトコンセプト
- **ターミナル完結型タスク管理**: GUIツールへの画面切り替えを排除し、開発者がターミナルから離れずにタスク管理を完結できる
- **Git統合によるシームレスな開発フロー**: タスクとGitブランチを1対1で紐付け、コミット・PR・マージとタスクステータスを自動連携
- **開発者ファーストのシンプル設計**: 1分で使い始められる学習コストの低さと、100ms以内のレスポンスタイムによる高速な操作感

### プロダクトビジョン
開発者がコードを書く流れを中断することなく、タスク管理を自然に行えるCLIツールを提供する。
タスクとブランチが常に紐付いた状態を維持し、「今どのタスクで作業しているか」が常に明確な開発体験を実現する。
画面切り替えによる集中力の分断をゼロにし、開発フローに溶け込むタスク管理を目指す。

### 目的
- ターミナル↔GUIツール間の画面切り替え回数をゼロにする
- タスク管理にかかる時間を50%削減する
- Git操作とタスク管理を統合し、手作業によるステータス更新を自動化する
- 小規模チーム(2-5人)でも導入が容易で、学習コストが低いツールを提供する

## ターゲットユーザー

### プライマリーペルソナ: 山田健太(28歳、フリーランスフルスタックエンジニア)
- **属性**: フリーランスで3-5プロジェクトを並行、開発歴5年以上、CLI操作に慣れている
- **技術環境**: Vim/VSCode + ターミナル環境、Git/GitHub、Node.js/Python/Go
- **現在の課題**:
  - 複数プロジェクトのタスクが頭の中だけで管理されており、「次何やるんだっけ?」となることが頻繁
  - GitHub Issuesは使っているが、ローカル作業との連携がなく、手動でステータス更新が必要
  - ターミナルとTrello/Asanaを1日20回以上切り替え、そのたびに集中力が途切れる
  - タスク完了時の手作業(ステータス更新→PR作成→タスククローズ)が面倒
- **期待する解決策**:
  - ターミナルで完結するタスク管理
  - Gitブランチと自動で連携し、コミット・マージでタスクステータスが自動更新される
  - シンプルで速く、学習コストが低い
- **1日の典型的なワークフロー**:
  1. 朝: ターミナル起動 → 今日やるタスクを確認
  2. タスク開始 → ブランチ自動作成 → コード実装 → コミット
  3. タスク完了 → PR作成 → マージ → タスク自動クローズ
  4. 夕方: 今日の進捗確認 → 明日のタスク優先順位調整

### セカンダリーペルソナ: 佐藤美咲(35歳、スタートアップのテックリード)
- **属性**: チーム規模2-5人、開発歴10年以上、チームマネジメント経験あり
- **技術環境**: VSCode + ターミナル、GitHub、Slack、TypeScript/React
- **現在の課題**:
  - チームメンバーが今何をやっているのかリアルタイムで把握したい
  - 朝会でのタスク確認に時間がかかりすぎる(10-15分)
  - JiraやAsanaは小規模チームには重すぎて、導入と運用が負担
- **期待する解決策**:
  - CLIでさっとチーム全体のタスク状況を確認できる
  - GitHub連携で自動的にタスク進捗が更新される
  - 軽量で導入が簡単、5分で使い始められる
- **1日の典型的なワークフロー**:
  1. 朝会前: チーム全体のタスク一覧をCLIで確認
  2. 朝会: 画面共有でタスク一覧を見せながら状況共有(5分以内)
  3. 日中: 自分のタスクも並行して進める
  4. 夕方: チームの進捗を確認し、ブロッカーがないかチェック

## 成功指標(KPI)

### プライマリーKPI
- **アクティブユーザー数**: リリース後3ヶ月で100人、6ヶ月で300人
  - 測定方法: 匿名の使用統計(オプトイン)、GitHub Stargazers数
- **継続率**: 1ヶ月後も使い続けているユーザーが60%以上
  - 測定方法: 初回使用から30日後の利用状況(オプトイン統計)
- **タスク管理時間の削減率**: 従来の50%削減(1日あたり平均10分→5分)
  - 測定方法: ユーザーアンケート、使用頻度統計

### セカンダリーKPI
- **導入率**: 紹介された開発者10人のうち3人以上が1週間継続して使用
  - 測定方法: ベータテストでのトラッキング
- **Net Promoter Score (NPS)**: 30以上
  - 測定方法: 四半期ごとのユーザーアンケート
- **GitHub Stars**: リリース後6ヶ月で500
  - 測定方法: GitHubのスター数
- **1日あたりの平均コマンド実行回数**: 10回以上
  - 測定方法: 匿名使用統計(オプトイン)

## 機能要件

### コア機能(MVP) - P0

#### 1. タスクの基本CRUD操作

**ユーザーストーリー**:
開発者として、ターミナルから離れずにタスクを管理するために、タスクの作成・一覧表示・詳細確認・完了・削除ができる機能が欲しい

**受け入れ条件**:
- [ ] `task add "タスク名"` でタスクを作成できる
- [ ] `task list` で全タスク一覧を表形式で表示できる(ID、ステータス、タイトル、ブランチ名)
- [ ] `task show <id>` でタスク詳細を表示できる(タイトル、説明、ステータス、作成日時、更新日時、関連ブランチ)
- [ ] `task done <id>` でタスクを完了状態にできる
- [ ] `task delete <id>` でタスクを削除できる(確認プロンプト付き)
- [ ] タスクデータは `.task/tasks.json` にJSON形式で保存される
- [ ] コマンド実行時間は100ms以内(平均的なPC環境、タスク数100件以下)

**優先度**: P0(必須)

#### 2. タスクステータス管理

**ユーザーストーリー**:
開発者として、タスクの進捗状況を把握するために、タスクに明確なステータスを付与して管理したい

**受け入れ条件**:
- [ ] タスクは以下のステータスを持つ: `open`(新規)、`in_progress`(作業中)、`completed`(完了)、`archived`(アーカイブ)
- [ ] `task start <id>` でタスクを `in_progress` に変更できる
- [ ] `task done <id>` でタスクを `completed` に変更できる
- [ ] `task archive <id>` でタスクを `archived` に変更できる
- [ ] `task list` でステータスごとに色分け表示される(例: open=白、in_progress=黄、completed=緑)
- [ ] `task list --status <status>` で特定ステータスのタスクのみ表示できる

**優先度**: P0(必須)

#### 3. タスクとGitブランチの自動連携

**ユーザーストーリー**:
開発者として、タスクとコードの紐付けを自動化するために、タスク開始時に専用ブランチを自動作成し、タスクとブランチを常に紐付けたい

**受け入れ条件**:
- [ ] `task start <id>` 実行時、`feature/task-<id>-<slug>` 形式のブランチを自動作成して切り替える
  - `<slug>` はタスク名から生成(例: "ユーザー認証機能" → "user-authentication")
- [ ] ブランチ名はタスクデータに記録される
- [ ] `task list` でタスクごとに関連ブランチ名を表示できる
- [ ] 既にブランチが存在する場合、そのブランチに切り替える
- [ ] Gitリポジトリが存在しない場合、エラーメッセージを表示し、Git統合機能を無効化する
- [ ] タスク完了時(`task done`)、現在のブランチがタスクのブランチと一致するか確認する

**優先度**: P0(必須)

#### 4. タスク一覧の見やすい表示

**ユーザーストーリー**:
開発者として、タスクの状況を一目で把握するために、見やすく整形されたタスク一覧を表示したい

**受け入れ条件**:
- [ ] `task list` で以下のカラムを表形式で表示: ID、ステータス、タイトル、ブランチ名
- [ ] ステータスは色分け表示される(ターミナルカラー使用)
- [ ] タイトルが長い場合、適切に省略される(40文字以内、`...`で省略)
- [ ] タスクが0件の場合、「タスクがありません」と表示される
- [ ] タスク数が1000件の場合でも1秒以内に表示される

**優先度**: P0(必須)

#### 5. タスクの初期化とヘルプ

**ユーザーストーリー**:
新規ユーザーとして、TaskCLIをすぐに使い始めるために、初期化コマンドとヘルプ機能が欲しい

**受け入れ条件**:
- [ ] `task init` で `.task/` ディレクトリと `tasks.json` を作成できる
- [ ] 既に初期化済みの場合、メッセージを表示して処理を中断する
- [ ] `task help` または `task --help` で全コマンドのヘルプを表示できる
- [ ] `task <command> --help` で特定コマンドの詳細ヘルプを表示できる
- [ ] ヘルプには各コマンドの説明、使用例、オプション一覧が含まれる

**優先度**: P0(必須)

### 重要機能(Post-MVP) - P1

#### 6. GitHub Issues連携

**ユーザーストーリー**:
開発者として、GitHub Issuesとローカルタスクを同期するために、双方向の連携機能が欲しい

**受け入れ条件**:
- [ ] `task sync` でローカルタスクとGitHub Issuesを双方向同期できる
- [ ] `task import --github` でGitHub Issuesをローカルタスクとしてインポートできる
- [ ] `task push <id>` で特定タスクをGitHub Issueとして作成できる
- [ ] GitHub Personal Access Tokenで認証を行う(`.task/config.json`に保存)
- [ ] 同期時、タイトル・説明・ステータス・ラベルを双方向で反映する
- [ ] 同期の競合が発生した場合、確認プロンプトを表示する

**優先度**: P1(重要)

#### 7. タスク完了時の自動処理

**ユーザーストーリー**:
開発者として、タスク完了時の手作業を削減するために、ブランチマージ・プッシュ・PR作成を自動化したい

**受け入れ条件**:
- [ ] `task done <id> --auto` で以下を自動実行:
  1. タスクのブランチを `main` ブランチにマージ
  2. リモートリポジトリにプッシュ
  3. (オプション)GitHub PRを自動作成
  4. タスクステータスを `completed` に変更
- [ ] マージ前に未コミットの変更がある場合、警告を表示して処理を中断
- [ ] マージでコンフリクトが発生した場合、エラーメッセージを表示して処理を中断
- [ ] `--no-merge` オプションでマージをスキップできる
- [ ] `--delete-branch` オプションで完了後にブランチを削除できる

**優先度**: P1(重要)

#### 8. タスクの絞り込み・検索

**ユーザーストーリー**:
開発者として、必要なタスクをすぐに見つけるために、ステータス・キーワードによる絞り込み機能が欲しい

**受け入れ条件**:
- [ ] `task list --status <status>` で特定ステータスのタスクのみ表示できる
- [ ] `task search <keyword>` でタイトル・説明に含まれるキーワードでタスクを検索できる
- [ ] `task list --assignee me` で自分にアサインされたタスクのみ表示できる(チーム機能有効時)
- [ ] 複数の絞り込み条件を組み合わせられる(例: `task list --status open --assignee me`)
- [ ] 検索結果が0件の場合、「該当するタスクがありません」と表示される

**優先度**: P1(重要)

#### 9. 優先度と期限の管理

**ユーザーストーリー**:
開発者として、タスクの重要度と緊急度を管理するために、優先度と期限を設定したい

**受け入れ条件**:
- [ ] `task add "タスク名" --priority <high|medium|low>` で優先度を設定できる
- [ ] `task add "タスク名" --due YYYY-MM-DD` で期限を設定できる
- [ ] `task update <id> --priority <high|medium|low>` で優先度を変更できる
- [ ] `task update <id> --due YYYY-MM-DD` で期限を変更できる
- [ ] `task list --sort priority` で優先度順にソートできる
- [ ] `task list --sort due` で期限順にソートできる
- [ ] 期限が近いタスク(3日以内)は警告色で表示される
- [ ] 期限切れのタスクはエラー色で表示される

**優先度**: P1(重要)

### 将来的な機能(できれば) - P2

#### 10. チーム機能

**ユーザーストーリー**:
チームリーダーとして、チーム全体のタスク状況を把握するために、メンバーのタスク一覧を表示したい

**受け入れ条件**:
- [ ] `task list --team` でチームメンバー全員のタスク一覧を表示できる
- [ ] `task assign <id> @<username>` でタスクを他のメンバーにアサインできる
- [ ] `.task/config.json` でチームメンバーを管理できる
- [ ] タスク一覧で担当者が表示される

**優先度**: P2(できれば)

#### 11. タスクテンプレート

**ユーザーストーリー**:
開発者として、定型的なタスクを素早く作成するために、テンプレート機能が欲しい

**受け入れ条件**:
- [ ] `task template create <name>` でテンプレートを作成できる
- [ ] `task add --template <name> "タスク名"` でテンプレートからタスクを作成できる
- [ ] テンプレートには説明、優先度、チェックリストを含められる
- [ ] `task template list` でテンプレート一覧を表示できる

**優先度**: P2(できれば)

#### 12. 作業時間の記録

**ユーザーストーリー**:
開発者として、タスクごとの作業時間を把握するために、自動的に作業時間を計測したい

**受け入れ条件**:
- [ ] `task start <id>` で作業時間の計測を開始する
- [ ] `task done <id>` で作業時間を記録する
- [ ] `task show <id>` で累計作業時間を表示できる
- [ ] `task list` で各タスクの作業時間を表示できる

**優先度**: P2(できれば)

### CLIインターフェース

```bash
# 初期化
task init

# タスクの基本操作
task add "ユーザー認証機能の実装"
task add "データエクスポート機能" --priority high --due 2025-01-20
task list
task list --status in_progress
task search "認証"
task show 1
task start 1  # ブランチ自動作成 & 切り替え
task done 1
task done 1 --auto  # マージ・プッシュ・PR作成まで自動化
task delete 1

# GitHub連携
task sync
task import --github
task push 1

# 優先度・期限管理
task update 1 --priority high
task update 1 --due 2025-01-25
task list --sort priority
task list --sort due

# チーム機能(P2)
task list --team
task assign 1 @alice

# テンプレート(P2)
task template create bug-fix
task add --template bug-fix "ログイン画面のバグ修正"

# ヘルプ
task help
task <command> --help
```

## 非機能要件

### パフォーマンス
- **コマンド実行時間**: 100ms以内(平均的なPC環境、タスク数100件以下)
  - 測定方法: 自動テストで各コマンドの実行時間を計測
- **タスク一覧表示**: タスク数1000件でも1秒以内に表示
  - 測定方法: 1000件のダミーデータで `task list` の実行時間を計測
- **起動時間**: CLIツールの初回起動は50ms以内
  - 測定方法: `time task list` で計測

### ユーザビリティ
- **学習時間**: 新規ユーザーが5分以内に基本操作(add/list/start/done)を習得できる
  - 測定方法: ユーザビリティテストで初回ユーザーに基本操作を試してもらい、完了時間を計測
- **ヘルプの充実度**: `task help` で全機能を確認でき、各コマンドに使用例が含まれる
  - 測定方法: ドキュメントレビューとユーザーフィードバック
- **エラーメッセージの明確性**: エラー発生時、原因と解決方法が明確に表示される
  - 測定方法: 全エラーケースに対して分かりやすいメッセージを定義し、ユーザーテストで検証

### 信頼性
- **データ損失ゼロ**: タスクデータは自動バックアップされ、ファイル破損時にリカバリできる
  - 測定方法: `.task/tasks.json.backup` に前回の状態を保存、復元テストを実施
- **エラー時のロールバック**: タスク完了の自動処理(`--auto`)でエラーが発生した場合、元の状態に戻る
  - 測定方法: 自動テストでエラーケースを作り、ロールバックを検証
- **危険な操作の確認**: `task delete` や `task done --auto` などの取り消しが難しい操作は、確認プロンプトを表示
  - 測定方法: 手動テストで確認プロンプトが表示されることを確認

### セキュリティ
- **認証情報の安全な保存**: GitHub Personal Access Tokenは `.task/config.json` に保存し、ファイルパーミッションを600(所有者のみ読み書き可)に設定
  - 測定方法: ファイル作成時のパーミッション設定を自動テストで確認
- **トークンの暗号化**: 可能であれば、OSのキーチェーン(macOS Keychain、Windows Credential Manager、Linux Secret Service)を使用
  - 測定方法: 各OS環境でトークン保存・取得のテストを実施
- **入力のサニタイズ**: ユーザー入力(タスク名、説明など)はシェルインジェクション攻撃を防ぐため、適切にエスケープする
  - 測定方法: 悪意のある入力パターンでテストし、脆弱性がないことを確認

### スケーラビリティ
- **タスク数の上限**: タスク数10,000件まで動作を保証
  - 測定方法: 10,000件のダミーデータで全コマンドの動作を検証
- **チーム規模**: 最大10人までのチームで動作を保証
  - 測定方法: 10人分のタスクデータでチーム機能をテスト

### 互換性
- **クロスプラットフォーム対応**: Windows、macOS、Linuxで動作する
  - 測定方法: 各OS環境でのCI/CDテスト
- **Node.jsバージョン**: Node.js 18以上で動作する
  - 測定方法: CI/CDで複数バージョンのNode.jsでテスト
- **Gitバージョン**: Git 2.30以上で動作する
  - 測定方法: 異なるGitバージョンでのテスト

## スコープ外

明示的にスコープ外とする項目:
- **GUI版の提供**: TaskCLIはCLI専用ツールとし、GUIは提供しない
- **モバイルアプリ**: モバイルデバイスでの使用はスコープ外
- **GitLab/Bitbucket連携**: MVPではGitHub連携のみサポート、他のプラットフォームは将来的に検討
- **カレンダー表示**: `task calendar` 機能はP2以降に検討
- **Slack/Discord通知**: 外部ツールとの通知連携は将来的に検討
- **タスク間の依存関係管理**: 親子関係や依存関係の管理は複雑化するため、当面はスコープ外
- **時間見積もり機能**: タスクごとの見積もり時間設定は将来的に検討
- **マイルストーン機能**: タスクをマイルストーンにグルーピングする機能は将来的に検討
- **レポート生成**: タスク完了率やベロシティなどのレポート機能は将来的に検討
